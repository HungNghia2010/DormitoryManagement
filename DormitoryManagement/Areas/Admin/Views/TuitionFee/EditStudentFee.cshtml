
@{
    ViewBag.Title = "Chỉnh sửa học phí";
}
@model DormitoryManagement.Areas.Admin.Data.FeeData

@section scripts{

    <script>
        function formatCurrency(number) {
            // Kiểm tra xem giá trị có phải là một số không
            if (isNaN(number)) {
                return "0";
            }

            // Chuyển số thành chuỗi và chia thành phần nguyên và phần thập phân
            var parts = number.toFixed(0).toString().split(".");
            var integerPart = parts[0];
            var decimalPart = parts.length > 1 ? "." + parts[1] : "";

            // Đảo ngược chuỗi phần nguyên và thêm dấu phân cách hàng nghìn
            var formattedInteger = integerPart.split("").reverse().join("").replace(/(\d{3}(?!$))/g, "$1,").split("").reverse().join("");

            // Kết hợp phần nguyên và phần thập phân vào chuỗi định dạng tiền tệ
            var formattedCurrency = formattedInteger + decimalPart;

            return formattedCurrency;
        }

        function handleChange(input) {
            // Lấy giá trị từ input và chỉ giữ lại các ký tự số và dấu chấm
            var value = input.value.replace(/[^\d.]/g, '');
            // Chuyển đổi giá trị thành số
            var number = parseFloat(value);
            // Định dạng lại giá trị và hiển thị trong input
            input.value = formatCurrency(number);
        }
    </script>
}

<div id="content-wrapper">
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <h2 class="text-center text-gray-800">Chỉnh Sửa Học Phí</h2>

                <!-- Form chỉnh sửa phòng -->
                @using (Html.BeginForm("EditStudentFee", "TuitionFee", FormMethod.Post))
                {
                    @Html.AntiForgeryToken()

                    @Html.HiddenFor(m => m.ID)

                    <div class="form-group row mt-5">
                        <div class="col-md-6">
                            <label for="NameStudent">Tên Sinh viên:</label>
                            @Html.TextBoxFor(m => m.FullName, new { @class = "form-control", @id = "NameStudent", @required = "required", @readonly = "readonly" })
                        </div>

                        <div class="col-md-6">
                            <label for="StudentID">Mã số sinh viên:</label>
                            @Html.TextBoxFor(m => m.StudentID, new { @class = "form-control", @id = "StudentID", @required = "required", @readonly = "readonly" })

                        </div>
                    </div>

                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="Descript">Nội dung:</label>
                            @Html.TextBoxFor(m => m.Descript, new { @class = "form-control", @id = "Descript", @required = "required", @readonly = "readonly" })
                        </div>

                        <div class="col-md-6">
                            <label for="MonthYear">Tháng ghi:</label>
                            @Html.TextBoxFor(m => m.MonthYear, new { @class = "form-control", @id = "MonthYear", @required = "required", @readonly = "readonly" })

                        </div>
                    </div>

                    <div class="form-group">
                        <label for="fee">Số tiền:<span class="text-danger">*</span></label>
                        @Html.TextBoxFor(m => m.TotalAmount, new { @class = "form-control", @id = "Price", @name = "fee", @oninput = "handleChange(this)" })
                    </div>

                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="roomname">Số phòng:</label>
                            @Html.TextBoxFor(m => m.RoomName, new { @class = "form-control", @id = "roomname", @required = "required", @readonly = "readonly" })
                        </div>

                        <div class="col-md-6">
                            <label for="Building">Số tòa:</label>
                            @Html.TextBoxFor(m => m.BuildingName, new { @class = "form-control", @id = "Building", @required = "required", @readonly = "readonly" })

                        </div>
                    </div>

                    <div class="form-group">
                        <label for="PaymentStatus">Trạng thái:</label>
                        @Html.TextBoxFor(m => m.PaymentStatus, new { @class = "form-control", @id = "PaymentStatus", })
                    </div>

                    <div class="form-group">
                        <label for="PaymentStatus">Ghi chú:</label>
                        @Html.TextBoxFor(m => m.StudentID, new { @class = "form-control", @id = "PaymentStatus", })
                    </div>

                    <!-- Hiển thị thông báo lỗi nếu có -->
                    if (@ViewBag.Error != null)
                    {
                        <div class="form-group text-center">
                            <span class="alert alert-danger" id="errorAlert">
                                @ViewBag.Error
                            </span>
                        </div>
                    }

                    <!-- Hiển thị thông báo thành công nếu có -->
                    if (@ViewBag.Success != null)
                    {
                        <div class="form-group text-center">
                            <span class="alert alert-success">@ViewBag.Success</span>
                        </div>
                    }

                    <div class="text-center mb-3">
                        <button type="submit" class="btn btn-primary">Cập nhật</button>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
